{% extends 'base.html' %}

{% block title %}List Users{% endblock %}

{% block nav_sub_header %}
<div class="conatiner-fluid">
  <ul class="breadcrumb airone-breadcrumb">
    <li class="breadcrumb-item"><a href="/">TOP</a></li>
    <li class="breadcrumb-item">ロール管理</li>
  </ul>
</div>
{% endblock %}

{% block content %}
{% csrf_token %}
<div class="container-fluid">
  <div class="row">
    <div class="col">
      <div class="float-left">
        <button name="button_new" type="button" class="btn btn-primary" onclick="location.href='/role/create'">新規作成</button>
        <button name="button_delete" type="button" class="btn btn-danger" onclick="location.href='/role/delete'">削除</button>
      </div>
    </div>
  </div>

  <table class='table table-sm'>
    <thead>
      <th scope='col'></th>
      <th scope='col'>名前</th>
      <th scope='col'>登録ユーザ・グループ</th>
      <th scope='col'>管理ユーザ・グループ</th>
    <thead>
    <tbody>
      {% for role in roles %}
      <tr>
        <td><input type="checkbox" value="{{ role.id }}"/></td>

        <!-- Role name -->
        <td><a href='/role/edit/{{ role.id }}'>{{ role.name }}</a></td>

        <!-- Registered Users and Groups -->
        <td>
          <ul class="list-group list-group-flush">
            {% for user in role.users %}
            <li>(user) {{ user.username }}</li>
            {% endfor %}
            {% for group in role.groups %}
            <li>(group) {{ group.name }}</li>
            {% endfor %}
          </ul>
        </td>

        <!-- Administrative Users and Groups -->
        <td>
          <ul class="list-group list-group-flush">
            {% for user in role.admin_users %}
            <li>(user) {{ user.username }}</li>
            {% endfor %}
            {% for group in role.admin_groups %}
            <li>(group) {{ group.name }}</li>
            {% endfor %}
          </ul>
        </td>

      </tr>
      {% endfor %}
    </tbody>
  </table>

  <!--
  <div class="row">
    <div class="col">
      <table class="table table-bordered">
        <thead>
          <tr>
            <td>名前</td>
            <td>メンバー</td>
            <td></td>
          </tr>
        </thead>
        <tbody>
          {% for role in roles %}
          <tr class='role-{{ role.id }}'>
            <td class='role_name'><a href="/role/edit/{{ role.id }}">{{ role.name }}</a></td>
            <td class='role_member'>
              <ul>
                {% for member in role.members %}
                <li>{{ member.username }}</li>
                {% endfor %}
              </ul>
            </td>
            <td class='role_delete'><button name="button_delete" type="button" class="btn btn-danger btn-sm del-item" url="/role/do_delete/{{ role.id }}">del</button></td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
  -->
</div>
{% endblock %}

{% block script %}
<script>
$(document).ready(function() {
  $('.del-item').on('click', confirm_delete_table_item);
});
</script>
{% endblock %}
